import{e as N,f as D,b as E,h as i,g as q,i as $,r as C,j as V,a as v,k as W}from"./vendor.8ab2a6ca.js";function M(t){history.pushState({},"history",t),window.dispatchEvent(new PopStateEvent("popstate"))}function z(t){return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}const P=()=>location.pathname+location.hash+location.search,R="(?:(?:/){0,1}#(?:/){0,1})",j="(?:/)";function B(t){const e=[],s=t.replace(/#(\/){0,1}/,"/#").split(/\//g).map(r=>{if(!r)return"";const[,o="",c,a,l]=r.match(/(#){0,1}([\{\[]){0,1}(\.\.\.){0,1}(\w*)([\}\]]){0,1}/);if(c=="{"||c=="["){e.push(l);const m=c=="["?"*":"+",p=(o?R:j)+(c=="["?"{0,1}":"{1}");return a?`${p}(.${m})`:`${p}([^/#]${m})`}else return(o?R:"/")+G(o?r.slice(1):r)}).join(""),n=!s.indexOf(R);return[RegExp((n?"":"^")+(s||j+"{0,1}")+(!n&&t!="/"&&t.endsWith("/")?"/":"")+"$"),e]}const G=t=>t.replace(/([.+^()\-:])/g,"\\$1"),k=t=>t.split(/(\?.*)/);function J(t,e={}){return t.replace(/(?:\?|&){1}([^=&]+)(?:=([^\?&]+)){0,1}/g,(s,n,r)=>(e[n]=r,"")),e}function K(t){const[e]=k(t),[s,n]=B(e);return o=>{const[c]=k(o),a=c.match(s);if(a){const[,...l]=a,m={};return l.reduce((p,u,h)=>(p[n[h]]=u,p),m)}}}const A={},Q=t=>A[t]=A[t]||K(t),X=(t,e)=>{const[s,n]=k(e),r=n?J(n):{};for(const o in t){const a=Q(o)(s);if(a)return[t[o](a,r),o,a,r]}};function Y(t){const e=N();return e.current=t,e}const H={};function Z(t){const[e,s]=D(H),n=Y(t);return E(()=>{s(H);const r=()=>{s(o=>{const c=P();return o.path!=c?{path:c,result:X(n.current,c)}:o})};return r(),z(r)},Object.keys(t)),e.result||[]}const tt=i("host");function x(t){return t&&typeof t=="object"?(t=t.type=="host"?t:i("host",null,t),t):tt}function et(t,e){const s=q();s.id=s.id||Symbol(),$(()=>C(x(t()),s.current,s.id),e),E(()=>()=>C(x(),s.current,s.id),[])}class st extends Event{#t=new I;#e=new I;constructor(e,s,n=!1){super(s,{bubbles:!0,composed:n});this.host=e}cast(e){this.#t.emit(this.castDown=e)}connect(e){e&&(this.observe=e),this.host.dispatchEvent(this);const s=n=>{n instanceof this.constructor&&n.type==this.type&&(n.stopPropagation(),n._sync(this))};this.host.addEventListener(this.type,s),this.#e.add(()=>{delete this.observe,this.host.removeEventListener(this.type,s)})}disconnect(){this.#e.emit()}_sync(e){const s=n=>{this.castUp=n,this.observe&&this.observe(n),!("castDown"in this)&&this.#t.emit(n)};this.#e.add(e.#t.add(s)),"castDown"in e?s(e.castDown):"castUp"in e&&s(e.castUp)}}class I extends Set{add=e=>super.add(e)&&(()=>this.delete(e));emit=e=>this.forEach(s=>s(e))}function L(t){const e=q(),[s,n]=D();return V(()=>{const r=new st(e.current,t,!0);return e.channel=r,r.connect(n),()=>r.disconnect()},[t]),[s,r=>e.channel.cast(r)]}function O(){return i("host",{shadowDom:!0})}O.props={slot:{type:String,reflect:!0,value:"router-case"},path:{type:String,reflect:!0,path:"/"},for:{type:String,reflect:!0},load:null};var nt=v(O),b=new Map;function T({transition:t,path:e}){const[s,n]=D(),[r,o]=W("request"),[c,a]=L("InheritPath"),l=(c||"")+(e||""),m=$(()=>{const u={};for(const h in s)u[l+h]=s[h];return u},[l,s]),p=Z(m);return E(()=>{a(l)},[l]),E(()=>{let[u,h,g]=p;if(!u)return;const{load:f,for:w}=u;if(w&&!b.has(w)&&b.set(w,Promise.resolve({forId:w})),f&&!b.has(f)){let d;typeof f=="string"?d=import(new URL(f,location).href):d=Promise.resolve(f(g)),b.set(f,d.then(S=>typeof S=="object"?S:{default:S}))}let y=b.get(f||w);return setTimeout(()=>y&&o({loading:!0}),40),y.then(async({default:d,forId:S,...U})=>{if(h!=P()){y=null;return}t&&await t(g),y=null,h==P()&&o({view:typeof d=="function"?d(g):d,forId:S,data:U})}),()=>y=null},[p]),et(()=>i("section",{slot:"view",key:P()},r.view),[r.view]),i("host",{shadowDom:!0,data:r.data},i("slot",{name:"router-case",onslotchange:u=>n([...u.target.assignedElements()].reduce((h,g)=>({...h,[g.path]:()=>g}),{}))}),i("slot",{name:r.forId||"view"}),r.loading&&i("slot",{name:"loading"}))}T.props={path:String,transition:Function,data:{type:Object,event:{type:"Data"}},request:{type:Object,event:{type:"Request"},value:Object}};var rt=v(T);function _({path:t}){const[,e]=L("InheritPath");return E(()=>e(t),[t]),i("host",{onclick:s=>{let{target:n}=s;do if(n.hasAttribute&&n.hasAttribute("href")&&!n.hasAttribute("ignore")){s.preventDefault();const r=n.getAttribute("href");!/^(http(s){0,1}:){0,1}\/\//.test(r)&&M((t||"")+r);break}while(n=n.parentNode)}})}_.props={path:String};var ot=v(_);function F({href:t}){const[e]=L("InheritPath"),s=(e||"")+(t||"");return i("host",{onclick:n=>{n.stopPropagation(),n.preventDefault(),s&&M(s)}})}F.props={href:String};var ct=v(F,HTMLAnchorElement);customElements.define("a-router-redirect",ot);customElements.define("a-router-switch",rt);customElements.define("a-router-case",nt);customElements.define("a-router-link",ct,{extends:"a"});export{nt as RouterCase,ct as RouterLink,ot as RouterRedirect,rt as RouterSwitch,P as getPath,M as redirect};
